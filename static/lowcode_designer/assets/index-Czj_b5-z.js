import{r as C,w as te,m as ne,al as f,c as p,o as u,a as o,Q as t,I as i,u as _,M as q,E as L,K as D,P as M,a5 as $,H as x,L as B,O as I,W as T,au as oe}from"./@vue-D4ddg5YP.js";import{E as m,a as y,b as ae,c as F,i as se}from"./element-plus-kFNNpB85.js";import{Q as le}from"./@element-plus-rwYtm5Wk.js";import"./lodash-es-C-8JW18d.js";import"./@vueuse-2nrTByN5.js";import"./@popperjs-DB1lLFnh.js";import"./@ctrl-BuyEbX8F.js";import"./dayjs-DVKSwKij.js";import"./async-validator-Cp9QasH9.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BikNlmlf.js";import"./@floating-ui-BiT_2Uhe.js";(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))b(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&b(d)}).observe(document,{childList:!0,subtree:!0});function h(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function b(s){if(s.ep)return;s.ep=!0;const r=h(s);fetch(s.href,r)}})();const ie=(g,v)=>{const h=g.__vccOpts||g;for(const[b,s]of v)h[b]=s;return h},re={class:"lowcode_designer"},ue={class:"designer-header"},ce={class:"header-content"},de={class:"header-buttons"},pe={class:"designer-main"},me={class:"component-library"},fe={class:"component-tabs"},ve={class:"component-list-container"},_e={key:0,class:"component-list"},ye=["onDragstart"],ge={class:"component-name"},he={key:1,class:"component-list"},be=["onDragstart"],Ce={class:"component-name"},ke={class:"canvas-container"},Ve={class:"canvas-list"},xe=["onClick"],Oe={class:"component-info"},Se={class:"canvas-component-name"},we={class:"canvas-component-type"},De={key:0,class:"canvas-empty"},Ie={class:"property-panel"},Ne={key:0,class:"panel-empty"},Ee={key:1,class:"panel-content"},qe={__name:"LowcodeDesigner",props:{initCanvasComponents:{type:Array,default:()=>[]}},setup(g,{expose:v}){const h=g,b=C([{id:1,name:"文本输入框",type:"text",key:"textInput",icon:"Edit",required:!1,defaultValue:"",unit:""},{id:2,name:"数值输入框",type:"number",key:"numberInput",icon:"DataAnalysis",required:!1,defaultValue:"",unit:""},{id:3,name:"日期选择器",type:"date",key:"datePicker",icon:"Calendar",required:!1,defaultValue:"",unit:""},{id:4,name:"下拉选择器",type:"select",key:"selectInput",icon:"Bottom",required:!1,defaultValue:"",options:[],unit:""},{id:5,name:"复选框",type:"checkbox",key:"checkbox",icon:"Checked",required:!1,defaultValue:!1,unit:""}]),s=C([{id:6,name:"温度输入框",type:"temperature",key:"temperature",icon:"HotWater",required:!0,defaultValue:"",unit:"℃"},{id:7,name:"设备选择器",type:"device",key:"deviceSelect",icon:"Setting",required:!0,defaultValue:"",options:["设备1","设备2"],unit:""},{id:8,name:"批次输入框",type:"batch",key:"batchId",icon:"Grid",required:!0,defaultValue:"",unit:""}]),r=C("basic"),d=C(null),c=C([]),l=C({id:"",name:"",type:"",key:"",required:!1,defaultValue:"",unit:"",options:[],index:-1});te(()=>h.initCanvasComponents,a=>{a&&a.length>0&&(c.value=JSON.parse(JSON.stringify(a)),m.success("已加载历史表单配置！"))},{immediate:!0}),ne(()=>{h.initCanvasComponents.length===0&&E()});const z=a=>{d.value=JSON.parse(JSON.stringify(a)),d.value.id=Date.now()+Math.floor(Math.random()*1e3),event?.dataTransfer&&event.dataTransfer.setData("text/plain",JSON.stringify(d.value))},J=()=>{d.value=null},A=()=>{d.value&&(c.value.push(d.value),m.success(`已添加「${d.value.name}」组件`),d.value=null)},H=(a,e)=>{l.value={...a,index:e}},k=()=>{const a=l.value.index;a>=0&&a<c.value.length&&(c.value[a]={...l.value},m.info("组件属性已更新"))},K=a=>{F.confirm("确定要删除该组件吗？此操作不可撤销！","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.value.splice(a,1),l.value.index===a&&(l.value={id:""}),m.success("组件已删除")}).catch(()=>{m.info("已取消删除")})},P=()=>{if(c.value.length===0)return m.warning("请先添加组件再保存！");try{localStorage.setItem("icentFormConfig",JSON.stringify(c.value)),m.success("表单配置已成功保存到本地！")}catch(a){m.error("保存失败："+a.message)}},E=()=>{try{const a=localStorage.getItem("icentFormConfig");a?(c.value=JSON.parse(a),m.success("已加载本地保存的配置！")):m.info("暂无本地配置，可开始创建新表单")}catch(a){m.error("加载配置失败："+a.message)}},U=()=>{if(c.value.length===0)return m.warning("请先添加组件再预览！");F.alert(`<pre style="text-align: left; max-height: 60vh; overflow-y: auto;">${JSON.stringify(c.value,null,2)}</pre>`,"表单结构预览",{dangerouslyUseHTMLString:!0,confirmButtonText:"关闭",customClass:"form-preview-modal"})};return v({canvasComponents:c,saveConfig:P,loadConfig:E,previewForm:U}),(a,e)=>{const Q=f("HomeFilled"),W=f("Save"),O=f("el-button"),j=f("View"),G=f("Upload"),R=f("CircleClose"),X=f("Operation"),S=f("el-input"),V=f("el-form-item"),Y=f("el-switch"),Z=f("el-form");return u(),p("div",re,[o("header",ue,[o("div",ce,[t(_(y),{class:"logo-icon"},{default:i(()=>[t(Q)]),_:1}),e[12]||(e[12]=o("h2",{class:"logo-text"},"Icent 工业低代码平台",-1)),o("div",de,[t(O,{type:"primary",onClick:P},{default:i(()=>[t(_(y),null,{default:i(()=>[t(W)]),_:1}),e[9]||(e[9]=q(" 保存配置 ",-1))]),_:1}),t(O,{type:"success",onClick:U},{default:i(()=>[t(_(y),null,{default:i(()=>[t(j)]),_:1}),e[10]||(e[10]=q(" 预览表单 ",-1))]),_:1}),t(O,{type:"info",onClick:E},{default:i(()=>[t(_(y),null,{default:i(()=>[t(G)]),_:1}),e[11]||(e[11]=q(" 加载配置 ",-1))]),_:1})])])]),o("main",pe,[o("aside",me,[e[13]||(e[13]=o("h3",{class:"library-title"},"工业组件库",-1)),o("div",fe,[o("button",{class:L(["tab-btn",{active:r.value==="basic"}]),onClick:e[0]||(e[0]=n=>r.value="basic")}," 基础组件 ",2),o("button",{class:L(["tab-btn",{active:r.value==="industrial"}]),onClick:e[1]||(e[1]=n=>r.value="industrial")}," 工业组件 ",2)]),o("div",ve,[r.value==="basic"?(u(),p("div",_e,[(u(!0),p(M,null,$(b.value,n=>(u(),p("div",{key:n.id,class:"component-item",draggable:"true",onDragstart:w=>z(n),onDragend:J,title:"拖拽到画布添加组件"},[t(_(y),{size:18,class:"component-icon"},{default:i(()=>[(u(),x(B(n.icon)))]),_:2},1024),o("span",ge,I(n.name),1)],40,ye))),128))])):D("",!0),r.value==="industrial"?(u(),p("div",he,[(u(!0),p(M,null,$(s.value,n=>(u(),p("div",{key:n.id,class:"component-item",draggable:"true",onDragstart:w=>z(n),onDragend:J,title:"拖拽到画布添加组件"},[t(_(y),{size:18,class:"component-icon"},{default:i(()=>[(u(),x(B(n.icon)))]),_:2},1024),o("span",Ce,I(n.name),1)],40,be))),128))])):D("",!0)])]),o("section",ke,[e[15]||(e[15]=o("h3",{class:"canvas-title"},"设计画布（拖拽组件到此处）",-1)),o("div",{class:"canvas",onDragover:e[2]||(e[2]=T(()=>{},["prevent"])),onDrop:A},[o("div",Ve,[(u(!0),p(M,null,$(c.value,(n,w)=>(u(),p("div",{key:n.id,class:L(["canvas-component",{selected:l.value.id===n.id}]),onClick:ee=>H(n,w)},[o("div",Oe,[t(_(y),{size:20,class:"canvas-component-icon"},{default:i(()=>[(u(),x(B(n.icon)))]),_:2},1024),o("span",Se,I(n.name),1),o("span",we,"("+I(n.type)+")",1)]),t(O,{size:"small",type:"danger",class:"delete-btn",onClick:T(ee=>K(w),["stop"]),title:"删除组件"},{default:i(()=>[t(_(y),null,{default:i(()=>[t(R)]),_:1})]),_:1},8,["onClick"])],10,xe))),128))]),c.value.length===0?(u(),p("div",De,[t(_(y),{class:"empty-icon"},{default:i(()=>[t(X)]),_:1}),e[14]||(e[14]=o("p",{class:"empty-text"},"从左侧组件库拖拽组件到此处开始设计",-1))])):D("",!0)],32)]),o("aside",Ie,[e[16]||(e[16]=o("h3",{class:"panel-title"},"组件属性",-1)),l.value.id?(u(),p("div",Ee,[t(Z,{model:l.value,"label-width":"80px",size:"small",onSubmit:e[8]||(e[8]=T(()=>{},["prevent"]))},{default:i(()=>[t(V,{label:"组件名称",prop:"name"},{default:i(()=>[t(S,{modelValue:l.value.name,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.name=n),onInput:k,placeholder:"请输入组件名称"},null,8,["modelValue"])]),_:1}),t(V,{label:"字段标识",prop:"key"},{default:i(()=>[t(S,{modelValue:l.value.key,"onUpdate:modelValue":e[4]||(e[4]=n=>l.value.key=n),onInput:k,placeholder:"请输入唯一字段标识"},null,8,["modelValue"])]),_:1}),t(V,{label:"是否必填",prop:"required"},{default:i(()=>[t(Y,{modelValue:l.value.required,"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.required=n),onChange:k,"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),t(V,{label:"默认值",prop:"defaultValue"},{default:i(()=>[t(S,{modelValue:l.value.defaultValue,"onUpdate:modelValue":e[6]||(e[6]=n=>l.value.defaultValue=n),onInput:k,placeholder:"请输入默认值"},null,8,["modelValue"])]),_:1}),["number","temperature"].includes(l.value.type)?(u(),x(V,{key:0,label:"单位",prop:"unit"},{default:i(()=>[t(S,{modelValue:l.value.unit,"onUpdate:modelValue":e[7]||(e[7]=n=>l.value.unit=n),onInput:k,placeholder:"如：℃、mm、kg 等"},null,8,["modelValue"])]),_:1})):D("",!0)]),_:1},8,["model"])])):(u(),p("div",Ne,[t(_(ae),{description:"请在画布中选中一个组件"})]))])])])}}},Le=ie(qe,[["__scopeId","data-v-080ac20c"]]),Me={__name:"App",setup(g){return(v,h)=>(u(),x(Le))}},N=oe(Me);N.use(se);for(const[g,v]of Object.entries(le))N.component(g,v);N.config.globalProperties.$ELEMENT={size:"small",zIndex:3e3};N.mount("#app");
